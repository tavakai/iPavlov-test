(this["webpackJsonpipavlov-form"]=this["webpackJsonpipavlov-form"]||[]).push([[0],{24:function(e,t,n){},25:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n.n(s),i=n(16),c=n.n(i),r=n(8),o=(n(24),n(4)),l=n(2),u=a.a.createContext(),j=(n(25),n(11)),m=n(9);function d(){var e=a.a.useState({}),t=Object(o.a)(e,2),n=t[0],i=t[1],c=a.a.useState({}),r=Object(o.a)(c,2),l=r[0],u=r[1],d=a.a.useState(!1),p=Object(o.a)(d,2),h=p[0],b=p[1],_=Object(s.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i(e),u(t),b(n)}),[i,u,b]);return{values:n,handleChange:function(e){var t=e.target,s=t.name,a=t.value;i(Object(m.a)(Object(m.a)({},n),{},Object(j.a)({},s,a))),u(Object(m.a)(Object(m.a)({},l),{},Object(j.a)({},s,t.validationMessage))),b(t.closest("form").checkValidity())},errors:l,isValid:h,resetForm:_}}var p=n(0),h=function(e){var t=e.isActive,n=e.responseStatus,a=Object(s.useState)(""),i=Object(o.a)(a,2),c=i[0],r=i[1];return Object(s.useEffect)((function(){409===n?r("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 \u0442\u0430\u043a\u0438\u043c email \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"):400===n?r("\u041f\u0440\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"):401===n?r("\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c"):200===n?r("\u0414\u0430\u043d\u043d\u044b\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b"):201===n&&r("\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c")}),[n]),Object(p.jsx)("section",{className:"modal ".concat(t?"modal_active":""),children:Object(p.jsx)("div",{className:"".concat(200===n||201===n?"modal__content_success":"modal__content"),children:Object(p.jsx)("p",{className:"modal__message",children:c})})})},b=function(e){var t=e.profileEditFn,n=e.signOut,a=e.modal,i=e.responseStatus,c=d(),r=Object(s.useContext)(u),l=Object(s.useState)(!0),j=Object(o.a)(l,2),m=j[0],b=j[1],_=Object(s.useState)(r.name),g=Object(o.a)(_,2),O=g[0],f=g[1],x=Object(s.useState)(r.email),N=Object(o.a)(x,2),A=N[0],v=N[1],S=Object(s.useState)(!1),C=Object(o.a)(S,2),y=C[0],w=C[1];return Object(s.useEffect)((function(){void 0!==r.name&&f(r.name),void 0!==r.email&&v(r.email),w(!1)}),[r]),Object(s.useEffect)((function(){O!==r.name||A!==r.email?b(!1):b(!0)}),[O,A,r.name,r.email]),Object(s.useEffect)((function(){y||(f(r.name),v(r.email))}),[y]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("section",{className:"profile",children:Object(p.jsx)("div",{className:"profile__content",children:Object(p.jsxs)("form",{action:"#",className:"profile__form",id:"profile__edit",onSubmit:function(e){e.preventDefault(),t({name:O,email:A})},children:[Object(p.jsxs)("fieldset",{className:"profile__fieldset",children:[Object(p.jsx)("legend",{className:"profile__legend",children:Object(p.jsxs)("h2",{className:"profile__title",children:["\u041f\u0440\u0438\u0432\u0435\u0442, ",r.name]})}),Object(p.jsxs)("div",{className:"profile__inputs",children:[Object(p.jsx)("span",{className:"profile__input-title",children:"\u0418\u043c\u044f"}),Object(p.jsx)("input",{type:"text",required:!0,className:"profile__input profile__input_name",minLength:"2",maxLength:"30",name:"name",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f",value:O,onChange:function(e){f(e.target.value),c.handleChange(e)},readOnly:y?null:"readonly"}),Object(p.jsx)("span",{className:"profile__error profile__error_name ".concat(y?"":"profile__error_off"),children:c.errors.name}),Object(p.jsx)("hr",{className:"profile__line"}),Object(p.jsx)("span",{className:"profile__input-title",children:"E-mail"}),Object(p.jsx)("input",{type:"email",required:!0,className:"profile__input profile__input_email",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u043e\u0447\u0442\u0443",value:A,onChange:function(e){v(e.target.value),c.handleChange(e)},pattern:"[a-zA-Z0-9.-_]{1,}@[a-zA-Z.-]{2,}[.]{1}[a-zA-Z]{2,}",readOnly:y?null:"readonly",name:"email"}),Object(p.jsx)("span",{className:"profile__error profile__error_email ".concat(y?"":"profile__error_off"),children:c.errors.email})]})]}),Object(p.jsx)("span",{className:"profile__notification-text",children:"\u041f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0444\u0438\u043b\u044f \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430."}),y?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{className:"profile__btn_submit ".concat(c.isValid&&!m?"profile__btn_submit-active":""),disabled:c.isValid&&!m?"":"disabled",type:"submit",form:"profile__edit",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),Object(p.jsx)("button",{className:"".concat(y?"profile__signout_show":"profile__signout_hide"),type:"button",onClick:function(e){e.preventDefault(),w(!1)},children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"})]}):Object(p.jsx)("button",{className:"profile__btn",type:"button",onClick:function(e){e.preventDefault(),w(!0)},children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(p.jsx)("button",{className:"".concat(y?"profile__signout_hide":"profile__signout_show"),type:"button",onClick:n,children:"\u0412\u044b\u0439\u0442\u0438 \u0438\u0437 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430"})]})})}),Object(p.jsx)(h,{isActive:a,responseStatus:i})]})},_="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAQgSURBVHgBvVg9TBRBFH6znIo/6Gli/Cu4qwQ1AQt/Ok5N1E6pbDRIZWGhFkYTC4bSzmtshdhqhE4L5eg0FhyJIla3FBBI/FkEFRFufN/ej3fH7swsHHzJ3u3P7M43b958770RtAocy8kUOaItr1RKELXzEVd84Bmfe3zu4nCEyOTzangsKbMUEcK2YSIn49scuiUUXcclRYNLQshlJjmelK7NC1bEjkzIHkfR7ZJV1gBXCeoba5a9poZaYi05mWgQ9IJP26m+cJcVndFZzwl7cHSitysmaGQdSAEY8EhrTl4OayDCSJFSfbQREOL6x+ae/hW3a29gFE5h+jYOAeSqiMGnMH11cPKo8Njnjlf6XKzyKc/7kC2pJqeRTmxpprPbWulkYzMdjBVem8sv0PjiNL3+NU5vfn+mqSXP5nPx4iI7XrpRttgxlgSlSNp85erO03RzV4dPzoSB+Sw9nh22Isj997IYyzKxoiwMkUE4QeT+7gt0aUe0hTrJpLpn+m3IeZsUJbNJ6flywT8pslDzJ/u6IpMCDvE0Pz9wg1o27zc1jS8S3S5ywqKgHtMb99hSFh8OBayd3nvFOP3Mpcv/P5KT7aIgpKEAoWc84iC8X3B9H4LDw/HRFlY9t/VweUFU4umPt/Tw+yvSAVGBJUulyABYKwgPvg76vgNyIAWA4MNvL0N96hovHKPVSLU7SogOXSOM+kRjYsV9jHpwPjybCXN4DGCnkZhIsZ7qnR5aVQt0hikxAeTOT6YpKti12uD8CV2jIIcfmI+c90VFHMS0Sh/kwON/Z2idEXdoFWgSW2i9AWJaOS6ttkociq17jPeMxIKmLWiV1hlujLOJrG5lvuEs4X6NjoHYtaZT9HTuHekA/0QYq7QwZgAyAr0LAwfzCUcoNUwaQBogoLW4t+eiTy4KKQDiGuQeVcRIZVjHRFaRHgg5TwKmD+QOs5wM/hwthyQQury9LVThITWThixjiUTGT3uOujJHBj1DWEJna8FUMRroiKFQHkvIZCG7UNRv+ihCkM4vTCj5lslaggtj/PvEOL9+RIbVCeDDq1F9G0sBsBaqdZw34Gc6nVnYdyu1laNnSvfiolry8/jJ5VlqZd+ySa0RU+9+eW6X+ytKf0rKAZxWVUnsa5EK3ELe1cIOv6scU0vFyPs/Ez4p0wr8z6ngW6XrqiqJE7TOhkLSaCXtSHsG6xPQvTwnh5U3qmIl6joWtzu0wWBS3bX7GCuCOJdPfUyumzYI6KvkV5UIzC5AjredOslipa4BHkihr6CHxm0oLgqGhEVpFwWIzzx9nbptKKuNO97alHkuq+pA0GMxT38oVts6WG91+tZDYcw16CoIuogu8yzkLlfZNi9YE6sEalHHER3FzeEEFY6SxKBjbBBnsTnMS26ULZShiPgHdOfIsn+V8ksAAAAASUVORK5CYII=",g=function(e){var t=e.handleSubmit,n=e.responseStatus,s=e.modal,a=d();return Object(p.jsxs)("section",{className:"login",children:[Object(p.jsxs)("div",{className:"content login__content",children:[Object(p.jsxs)("form",{action:"#",name:"login",className:"login__form",onSubmit:function(e){e.preventDefault(),t(a.values)},children:[Object(p.jsx)(r.c,{to:"/",className:"login__logo",children:Object(p.jsx)("img",{src:_,className:"login__logo-img",alt:"logo"})}),Object(p.jsxs)("fieldset",{className:"login__fieldset",children:[Object(p.jsx)("legend",{children:Object(p.jsx)("h2",{className:"login__title",children:"\u0420\u0430\u0434\u044b \u0432\u0438\u0434\u0435\u0442\u044c!"})}),Object(p.jsx)("p",{className:"login__input-title",children:"E-mail"}),Object(p.jsx)("input",{type:"email",className:"login__input login__input_email",required:!0,name:"email",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 email",autoComplete:"username",onChange:function(e){a.handleChange(e)},pattern:"[a-zA-Z0-9.-_]{1,}@[a-zA-Z.-]{2,}[.]{1}[a-zA-Z]{2,}"}),Object(p.jsx)("span",{className:"login__error login__error_email",children:a.errors.email}),Object(p.jsx)("p",{className:"login__input-title",children:"\u041f\u0430\u0440\u043e\u043b\u044c"}),Object(p.jsx)("input",{type:"password",className:"login__input login__input_password",required:!0,name:"password",minLength:"8",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",autoComplete:"current-password",onChange:function(e){a.handleChange(e)}}),Object(p.jsx)("span",{className:"login__error login__error_password",children:a.errors.password})]}),Object(p.jsx)("button",{type:"submit",disabled:"".concat(a.isValid?"":"disabled"),className:"login__btn ".concat(a.isValid?"login__btn_active":""),children:"\u0412\u043e\u0439\u0442\u0438"})]}),Object(p.jsxs)("span",{className:"login__signup-text",children:["\u0415\u0449\u0451 \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?\xa0",Object(p.jsx)(r.b,{to:"/signup",className:"login__signup-btn",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})]})]}),Object(p.jsx)(h,{isActive:s,responseStatus:n})]})},O=function(e){var t=e.handleSubmit,n=e.modal,s=e.responseStatus,a=d();return Object(p.jsxs)("section",{className:"register",children:[Object(p.jsxs)("div",{className:"content register__content",children:[Object(p.jsxs)("form",{action:"#",name:"register",className:"register__form",onSubmit:function(e){e.preventDefault(),t(a.values)},children:[Object(p.jsx)(r.b,{to:"/",className:"register__logo",children:Object(p.jsx)("img",{src:_,className:"register__logo-img",alt:"logo"})}),Object(p.jsxs)("fieldset",{className:"register__fieldset",children:[Object(p.jsx)("legend",{children:Object(p.jsx)("h2",{className:"register__title",children:"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c!"})}),Object(p.jsx)("p",{className:"register__input-title",children:"\u0418\u043c\u044f"}),Object(p.jsx)("input",{type:"text",className:"register__input register__input_name",required:!0,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f",onChange:function(e){a.handleChange(e)},minLength:"2",maxLength:"30",name:"name"}),Object(p.jsx)("span",{className:"register__error register__error_name",children:a.errors.name}),Object(p.jsx)("p",{className:"register__input-title",children:"E-mail"}),Object(p.jsx)("input",{type:"email",className:"register__input register__input_email",required:!0,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 email",autoComplete:"username",onChange:function(e){a.handleChange(e)},name:"email",pattern:"[a-zA-Z0-9.-_]{1,}@[a-zA-Z.-]{2,}[.]{1}[a-zA-Z]{2,}"}),Object(p.jsx)("span",{className:"register__error register__error_email",children:a.errors.email}),Object(p.jsx)("p",{className:"register__input-title",children:"\u041f\u0430\u0440\u043e\u043b\u044c"}),Object(p.jsx)("input",{type:"password",className:"register__input register__input_password",required:!0,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",autoComplete:"current-password",minLength:"8",name:"password",onChange:function(e){a.handleChange(e)}}),Object(p.jsx)("span",{className:"register__error register__error_password",children:a.errors.password})]}),Object(p.jsx)("button",{type:"submit",disabled:"".concat(a.isValid?"":"disabled"),className:"register__btn ".concat(a.isValid?"register__btn_active":""),children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(p.jsxs)("span",{className:"register__signin-text",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?\xa0",Object(p.jsx)(r.b,{to:"/signin",className:"register__signin-btn",children:"\u0412\u043e\u0439\u0442\u0438"})]})]}),Object(p.jsx)(h,{isActive:n,responseStatus:s})]})},f="https://api.moviestavakai.nomoredomains.rocks",x={Accept:"application/json","Content-Type":"application/json"},N=function(){return fetch("".concat(f,"/users/me"),{method:"GET",headers:x,credentials:"include"}).then((function(e){return A(e)}))},A=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))},v=n(19),S=["component"],C=function(e){var t=e.component,n=Object(v.a)(e,S);return Object(p.jsx)(l.b,{children:function(){return!0===n.loggedIn?Object(p.jsx)(t,Object(m.a)({},n)):Object(p.jsx)(l.a,{to:"/"})}})};var y=function(){var e=Object(s.useState)({name:"",email:""}),t=Object(o.a)(e,2),n=t[0],a=t[1],i=Object(s.useState)(!1),c=Object(o.a)(i,2),r=c[0],j=c[1],m=Object(s.useState)(!1),d=Object(o.a)(m,2),_=d[0],v=d[1],S=Object(s.useState)(null),y=Object(o.a)(S,2),w=y[0],E=y[1],T=Object(l.g)(),I=Object(l.h)();return Object(s.useEffect)((function(){N().then((function(e){a(e),j(!0),T.push(I.pathname)})).catch((function(e){return j(!1),T.push("/signin"),e}))}),[]),Object(p.jsx)(u.Provider,{value:n,children:Object(p.jsx)("div",{className:"App",children:Object(p.jsxs)("div",{className:"page",children:[Object(p.jsxs)(l.d,{history:T,children:[Object(p.jsx)(C,{exact:!0,path:"/",profileEditFn:function(e){(function(e){return fetch("".concat(f,"/users/me"),{method:"PATCH",headers:x,credentials:"include",body:JSON.stringify({name:e.name,email:e.email})}).then((function(e){return A(e)}))})(e).then((function(e){a(e),v(!0),E(200),setTimeout((function(){v(!1)}),4e3)})).catch((function(e){console.log(e)}))},signOut:function(){fetch("".concat(f,"/signout"),{method:"POST",headers:x,credentials:"include"}).then((function(e){return A(e)})).then((function(e){j(!1),a({}),T.push("/signup")})).catch((function(e){return e}))},loggedIn:r,component:b,modal:_,responseStatus:w}),Object(p.jsx)(l.b,{path:"/signin",children:r?Object(p.jsx)(l.a,{to:"/"}):Object(p.jsx)(g,{handleSubmit:function(e){var t;(t=e,fetch("".concat(f,"/signin"),{method:"POST",headers:x,credentials:"include",body:JSON.stringify({email:t.email,password:t.password})}).then((function(e){return e.json()})).then((function(e){if(e.token)return e}))).then((function(e){e?(j(!0),T.push("/"),N().then((function(e){a(e)}))):void 0===e&&(v(!0),E(401),setTimeout((function(){v(!1)}),4e3))})).catch((function(e){console.log(e)}))},modal:_,responseStatus:w})}),Object(p.jsx)(l.b,{path:"/signup",children:r?Object(p.jsx)(l.a,{to:"/"}):Object(p.jsx)(O,{handleSubmit:function(e){(function(e){return fetch("".concat(f,"/signup"),{method:"POST",headers:x,credentials:"include",body:JSON.stringify({email:e.email,name:e.name,password:e.password})}).then((function(e){return e.ok?e:Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}))})(e).then((function(e){return 201===e.status&&(j(!0),N().then((function(e){a(e)})),T.push("/"),v(!0),E(201),setTimeout((function(){v(!1)}),4e3)),e.json()})).catch((function(e){"\u041e\u0448\u0438\u0431\u043a\u0430: 409"===e.message?(v(!0),E(409),setTimeout((function(){v(!1)}),4e3)):"\u041e\u0448\u0438\u0431\u043a\u0430: 400"===e.message&&(v(!0),E(400),setTimeout((function(){v(!1)}),4e3))}))},modal:_,responseStatus:w})}),r?Object(p.jsx)(l.a,{to:"/"}):Object(p.jsx)(l.a,{to:"/signin"})]}),Object(p.jsx)(h,{isActive:_,responseStatus:w})]})})})},w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),s(e),a(e),i(e),c(e)}))};c.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(r.a,{basename:"/",children:Object(p.jsx)(y,{})})}),document.getElementById("root")),w()}},[[35,1,2]]]);
//# sourceMappingURL=main.d473cc5d.chunk.js.map